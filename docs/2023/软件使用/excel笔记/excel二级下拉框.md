# excel二级下拉框

> 2024年6月3日20:59:54

* 名称管理器的使用
* 通过【数据】-【下拉列表】-【从单元格选择下拉列表】来定义一级下拉列表
* 通过INDIRECT函数与名称来定义二级下拉列表

## 一、新增一级下拉列表

> 在开始之前，自行去定义一级下拉列表所引用的单元格内容。

> 注意：选择的范围可以跨sheet,甚至可以直接设置`=名称`

1. 左键选中一个单元格
2. 导航栏【数据】-【下拉列表】-【从单元格选择下拉列表】
3. 然后从自己的工作簿中选择对应的单元格范围，点击【确定】即可
4. 对于带下拉框的单元格，可以拖动，这样其他单元格也引用了下拉框

## 二、新增二级列表

1. 首先，我们需要专门为每个一级列表的选项写二级列表的值。记住：只有写了的才有二级列表。

2. 我们可以选中我们写的一个二级列表，去【公式】-【名称管理器】为其设置名称，名称为对应的一级选项。

3. 比如对于一级列表的选项“蔡徐坤”，我们写了“唱”，“跳”，“rap”这三个单元格，我们需要选中这三个，设置名称为“蔡徐坤”。名称的引用位置是我们刚选中的三个单元格。

4. 选择单元格，比如我们的选项“蔡徐坤”位于H4，我们在他旁边的单元格H5左键

5. 然后去导航栏【数据】-【下拉列表】-【从单元格选择下拉列表】，但这里不选择单元格，我们输入公式：

```vbscript
=INDIRECT(H4)
```

6. 这里是H4单元格对应”蔡徐坤“这三个字，”蔡徐坤“又对应这我们刚定义的【名称】，名称下面是“唱”，“跳”，“rap“，所以二级下拉框的也是这三个选项。

## 三、调试列表值

> 有的时候单元格需要调试

1. 左键选中有下拉列表的单元格
2. 导航栏【数据】-【有效性】-【有效性】
3. 然后可以看到该单元格所引用值的【来源】。如果是单元格范围，我们可以重设；
4. 如果【来源】后面是个`=名称`这种格式，一看就不是单元格的。那就是名称，我们要去【名称管理器】改
5. 注：名称管理器位于【公式】导航栏，其实就是“全局变量”的意思

* 甚至可以去【公式】-【显示公式】，这样就可以看到哪些单元格用了公式。