<!doctype html>
<html lang="zh-CN">

<head>
    <meta charset="utf-8">
    <title>登录页面</title>
    <link href="./assets/bootstrap.min.css" rel="stylesheet">
    <style>
        .mixJade {
            width: 38%;
            top: 15%;
            left: 31%;
            text-align: center;
            justify-content: center;
            align-items: center;
            box-shadow: 7px 7px 17px rgba(52, 56, 66, 0.5);
            background: rgba(0, 0, 0, 30%);
            border-radius: 5px;
            position: absolute;
            backface-visibility: hidden;
            transition: all 1s;
            user-select: none;
        }

        #pairJade02 {
            transform: rotateY(-108deg);
        }

        img {
            cursor: pointer;
        }

        body {
            background-image: url("./picture/dio-na.jpg");
        }

        /*警告框*/
        #alertWrapper {
            position: absolute;
            width: 40%;
            top:30%;
            left: 30%;
            z-index: 100;
        }
    </style>
</head>

<body>
<!--警告框-->
<div id="alertWrapper"></div>
<!-- 用户登录 -->
<div class="mixJade" id="pairJade">
    <form class="container" style="width: 80%;" onsubmit="return false">
        <img class="mb-4" id="myImg01" src="./picture/mia.svg" alt="管理员入口" width="72" height="57">
        <h1 class="h3 mb-3 fw-normal text-white">用户登录</h1>

        <div class="form-floating">
            <input type="text" class="form-control" id="userInput01" placeholder="username" autocomplete="off">
            <label for="userInput01">账号</label>
        </div>
        <div class="form-floating">
            <input type="password" class="form-control" id="password01" placeholder="Password">
            <label for="password01">密码</label>
        </div>

        <div class="mb-3">
            <label class="text-white">
                <input type="checkbox" value="remember-me" id="remember01" checked> 记住我
            </label>
        </div>
        <button class="w-100 btn btn-lg btn-primary" type="submit" onclick="loginUser()">登录</button>
        <div class="row row-cols-1 row-cols-md-3">
            <a href="index.html">游客登录</a>
            <a href="#">进行注册</a>
            <a href="#">找回密码</a>
        </div>
        <p class="mt-5 mb-3 text-muted">&copy; 2022 - 2023</p>
    </form>
</div>
<!-- 管理员登录 -->
<div class="mixJade" id="pairJade02" onsubmit="return false">
    <form class="container" style="width: 80%;">
        <img class="mb-4" id="myImg02" src="./picture/mia.svg" alt="普通入口" width="72" height="57">
        <h1 class="h3 mb-3 fw-normal text-white">管理员登录</h1>

        <div class="form-floating">
            <input type="text" class="form-control" id="userInput02" placeholder="username" autocomplete="off">
            <label for="userInput02">账号</label>
        </div>
        <div class="form-floating">
            <input type="password" class="form-control" id="password02" placeholder="Password">
            <label for="password02">密码</label>
        </div>

        <div class="mb-3">
            <label class="text-white">
                <input type="checkbox" value="remember-me" id="remember02" checked> 记住我
            </label>
        </div>
        <button class="w-100 btn btn-lg btn-success" type="submit" onclick="loginAdmin()">管理员登录</button>
        <p class="mt-5 mb-3 text-muted">&copy; 2022 - 2023</p>
    </form>
</div>
</body>
<script src="assets/axios.js"></script>
<script src="assets/bootstrap.bundle.min.js"></script>
<script>
    // 卡片翻转
    const pairJade = document.getElementById("pairJade")
    const pairJade02 = document.getElementById("pairJade02")
    const myImg01 = document.getElementById("myImg01")
    const myImg02 = document.getElementById("myImg02")
    myImg01.addEventListener("click", () => {
        pairJade.style.transform = "rotateY(180deg)"
        pairJade02.style.transform = "rotateY(0deg)";
    })
    myImg02.addEventListener("click", () => {
        pairJade.style.transform = "rotateY(0deg)"
        pairJade02.style.transform = "rotateY(-180deg)";
    })// 管理员登录
    function loginAdmin() {
        const formJson = {
            "username": document.getElementById("userInput02").value,
            "password": document.getElementById("password02").value,
            "remember": document.getElementById("remember02").checked
        };
        axios.post("http://localhost:8080/login/admin", formJson)
            .then(resp => {
                if (resp.data["code"] === 1) {
                    location.href = "backstage/index.html"
                } else {
                    showAlert(resp.data["msg"])
                }
            })
    }// 用户登录
    function loginUser() {
        const formJson = {
            "username": document.getElementById("userInput01").value,
            "password": document.getElementById("password01").value,
            "remember": document.getElementById("remember01").checked
        };
        axios.post("http://localhost:8080/login/user", formJson)
            .then(resp => {
                if (resp.data["code"] === 1) {
                    location.href = "index.html"
                } else {
                    showAlert(resp.data["msg"])
                }
            })
    }//处理get请求
    window.onload = function () {
        const href = window.location.href
        if (href.indexOf("?") !== -1 && href.split("?")[1] === "noPower") {
            showAlert("你没有权限")
        }
    }//警告框
    const myAlert = document.getElementById('alertWrapper');//弹出警告框
    function showAlert(text) {
        myAlert.innerHTML = '<div class="alert alert-warning alert-dismissible fade show" role="alert" id="myAlert"><strong>'
            + text
            + '</strong><button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button></div>'
    }
</script>

</html>